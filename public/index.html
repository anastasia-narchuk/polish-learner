<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Polski Learner</title>

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css">

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-left">
        <h1>Polski Learner</h1>
        <button id="theme-toggle" class="theme-toggle" aria-label="Переключить тему">
          <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="4"></circle>
            <path d="M12 2v2"></path>
            <path d="M12 20v2"></path>
            <path d="m4.93 4.93 1.41 1.41"></path>
            <path d="m17.66 17.66 1.41 1.41"></path>
            <path d="M2 12h2"></path>
            <path d="M20 12h2"></path>
            <path d="m6.34 17.66-1.41 1.41"></path>
            <path d="m19.07 4.93-1.41 1.41"></path>
          </svg>
          <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
          </svg>
        </button>
      </div>
      <nav>
        <button class="tab-btn active" data-tab="reading">
          <i data-lucide="book-open"></i>
          Чтение
        </button>
        <button class="tab-btn" data-tab="flashcards">
          <i data-lucide="layers"></i>
          Карточки <span id="cards-count">(0)</span>
        </button>
      </nav>
    </header>

    <!-- Вкладка чтения -->
    <main id="reading-tab" class="tab-content active">
      <section class="generator">
        <input
          type="text"
          id="topic-input"
          placeholder="Тема текста (напр.: поход в магазин, разговор с врачом)"
        >
        <button id="generate-btn">
          <i data-lucide="sparkles"></i>
          Сгенерировать
        </button>
      </section>

      <div class="content-area">
        <section class="text-area">
          <div id="polish-text" class="polish-text">
            <p class="placeholder">Введи тему и нажми "Сгенерировать" чтобы получить текст на польском</p>
          </div>
        </section>

        <aside class="sidebar">
          <div id="translation-panel" class="translation-panel hidden">
            <h3>Перевод</h3>
            <div id="translation-content">
              <p class="selected-word" id="selected-word"></p>
              <p class="translation" id="translation-text"></p>
              <p class="base-form" id="base-form"></p>
              <p class="part-of-speech" id="part-of-speech"></p>
              <p class="note" id="translation-note"></p>
            </div>
            <button id="add-card-btn" class="add-card-btn">
              <i data-lucide="plus"></i>
              Добавить в карточки
            </button>
          </div>

          <div id="empty-sidebar" class="empty-sidebar">
            <i data-lucide="mouse-pointer-click"></i>
            <p>Кликни на слово или выдели текст для перевода</p>
          </div>
        </aside>
      </div>

      <!-- Кнопка перевода выделенного текста -->
      <div id="selection-popup" class="selection-popup hidden">
        <button id="translate-selection-btn">
          <i data-lucide="languages"></i>
          Перевести
        </button>
      </div>
    </main>

    <!-- Вкладка карточек -->
    <main id="flashcards-tab" class="tab-content">
      <section class="flashcards-controls">
        <button id="start-review-btn" class="review-btn">
          <i data-lucide="repeat"></i>
          Начать повторение
        </button>
        <button id="show-list-btn" class="list-btn active">
          <i data-lucide="list"></i>
          Список карточек
        </button>
        <button id="import-btn" class="import-btn">
          <i data-lucide="file-text"></i>
          Импорт слов
          <span id="unrecognized-badge" class="unrecognized-badge hidden">0</span>
        </button>
      </section>

      <!-- Режим просмотра списка -->
      <section id="cards-list" class="cards-list">
        <div id="cards-container"></div>
      </section>

      <!-- Режим повторения -->
      <section id="review-mode" class="review-mode hidden">
        <div class="review-card">
          <div class="card-front" id="card-front">
            <p class="review-word" id="review-word"></p>
            <p class="review-example" id="review-example"></p>
          </div>
          <div class="card-back hidden" id="card-back">
            <p class="review-translation" id="review-translation"></p>
          </div>
        </div>

        <button id="show-answer-btn" class="show-answer-btn">
          <i data-lucide="eye"></i>
          Показать перевод
        </button>

        <div class="review-controls hidden" id="review-controls">
          <button id="btn-incorrect" class="btn-incorrect">
            <i data-lucide="x"></i>
            Не знаю
          </button>
          <button id="btn-correct" class="btn-correct">
            <i data-lucide="check"></i>
            Знаю
          </button>
        </div>

        <div class="review-progress">
          <span id="review-progress">0 / 0</span>
        </div>
      </section>
    </main>
  </div>

  <!-- Import Modal -->
  <div id="import-modal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h2>Импорт слов</h2>
        <button id="modal-close-btn" class="modal-close" aria-label="Закрыть">
          <i data-lucide="x"></i>
        </button>
      </div>

      <!-- Mode tabs inside modal -->
      <div class="modal-tabs">
        <button class="modal-tab active" data-import-mode="comma">Через запятую</button>
        <button class="modal-tab" data-import-mode="lines">По строкам</button>
        <button class="modal-tab" data-import-mode="notes">Заметки</button>
        <button class="modal-tab" data-import-mode="manual">Вручную</button>
      </div>

      <!-- Input phase -->
      <div id="import-input-phase">
        <!-- Modes 1-3: textarea -->
        <div id="import-textarea-container">
          <textarea id="import-textarea" rows="8"
            placeholder="kot, pies, dom, szkoła"></textarea>
          <p class="import-hint" id="import-hint">Введите польские слова через запятую</p>
        </div>

        <!-- Mode 4: manual entry -->
        <div id="manual-entry-container" class="hidden">
          <input type="text" id="manual-polish" class="manual-input" placeholder="Польское слово" maxlength="200">
          <input type="text" id="manual-russian" class="manual-input" placeholder="Русский перевод" maxlength="200">
        </div>

        <button id="import-process-btn" class="import-process-btn">
          <i data-lucide="search"></i>
          <span id="import-process-btn-text">Обработать</span>
        </button>
      </div>

      <!-- Preview/review phase -->
      <div id="import-preview-phase" class="hidden">
        <div id="import-preview-list" class="import-preview-list"></div>

        <!-- Warnings section for Mode 3 -->
        <div id="import-warnings" class="import-section hidden">
          <h4>Предупреждения</h4>
          <ul id="warnings-list"></ul>
        </div>

        <!-- Unrecognized section for Mode 3 -->
        <div id="import-unrecognized" class="import-section hidden">
          <h4>Нераспознанные слова</h4>
          <p class="import-section-note">Сохранены для просмотра позже</p>
          <ul id="unrecognized-list"></ul>
        </div>

        <div class="import-actions">
          <button id="import-back-btn" class="import-back-btn">
            <i data-lucide="arrow-left"></i>
            Назад
          </button>
          <button id="import-save-btn" class="import-save-btn">
            <i data-lucide="check"></i>
            Добавить выбранные (<span id="selected-count">0</span>)
          </button>
        </div>
      </div>

      <!-- Unrecognized words review section -->
      <div id="import-unrecognized-review" class="hidden">
        <div class="import-section-divider"></div>
        <h4 class="import-section-title">Нераспознанные слова для ревью</h4>
        <div id="unrecognized-review-list"></div>
      </div>
    </div>
  </div>

  <div id="loading-overlay" class="loading-overlay hidden">
    <div class="spinner"></div>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script src="app.js"></script>
</body>
</html>
